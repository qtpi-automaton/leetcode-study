**Back (The Answer):**
* **Pattern/Algo:** HashMap + Binary Search (store only changes per index)
* **Complexity:** Time: $O(\log S)$ get, $O(1)$ set/snap | Space: $O(N + S)$
